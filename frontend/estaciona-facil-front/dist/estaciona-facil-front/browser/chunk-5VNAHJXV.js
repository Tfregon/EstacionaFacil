import{c as H,e as N,f as j,g as A,h as W,i as B,j as R,k as z,l as U,m as q}from"./chunk-LXIWNHXD.js";import{Fa as h,Ha as r,Ia as e,K as y,Ka as v,La as u,Ma as d,Oa as n,P as D,Pa as _,Qa as m,Ra as b,Sa as f,Ta as C,Va as M,W as p,Wa as w,X as g,hb as k,ib as O,jb as I,kb as T,na as l,ob as F,pb as E,ra as S,va as P,za as x}from"./chunk-BEARXXYF.js";var V=class s{constructor(o,t){this.http=o;this.auth=t}apiUrl="estacionafacilapi20250404165631.azurewebsites.net/api";getHeaders(){return new F({Authorization:`Bearer ${this.auth.getToken()}`})}getActiveVehicles(){return this.http.get(`${this.apiUrl}/Vehicles/active`,{headers:this.getHeaders()})}registrarSaida(o,t=null){let a=t!==null?{additionalAmount:t}:{};return this.http.put(`${this.apiUrl}/Vehicles/exit/${o}`,a,{headers:this.getHeaders()})}getCashToday(){return this.http.get(`${this.apiUrl}/Cash/today`,{headers:this.getHeaders()})}static \u0275fac=function(t){return new(t||s)(D(E),D(q))};static \u0275prov=y({token:s,factory:s.\u0275fac,providedIn:"root"})};function K(s,o){if(s&1&&(r(0,"div",11)(1,"h3"),n(2,"\u{1F4B0} Total do Caixa de Hoje:"),e(),r(3,"p",12),n(4),e()()),s&2){let t=d();l(4),m("R$ ",t.cashToday==null?null:t.cashToday.toFixed(2),"")}}function Q(s,o){if(s&1){let t=v();r(0,"div",13)(1,"h3"),n(2,"Status do Sistema"),e(),r(3,"p")(4,"strong"),n(5,"Hora do Servidor:"),e(),n(6),M(7,"date"),e(),r(8,"p")(9,"strong"),n(10,"Backend:"),e(),n(11),e(),r(12,"p")(13,"strong"),n(14,"Banco de Dados:"),e(),n(15),e(),r(16,"p")(17,"strong"),n(18,"Ambiente:"),e(),n(19),e(),r(20,"button",3),u("click",function(){p(t);let i=d();return g(i.fecharStatus())}),n(21,"Fechar"),e()()}if(s&2){let t=d();l(6),m(" ",w(7,4,t.sistemaStatus==null?null:t.sistemaStatus.serverTime,"short"),""),l(5),m(" ",t.sistemaStatus==null?null:t.sistemaStatus.backend,""),l(4),m(" ",t.sistemaStatus==null?null:t.sistemaStatus.database,""),l(4),m(" ",t.sistemaStatus==null?null:t.sistemaStatus.environment,"")}}function X(s,o){if(s&1){let t=v();r(0,"div",13)(1,"h3"),n(2,"Vers\xE3o do Sistema"),e(),r(3,"p")(4,"strong"),n(5,"Projeto:"),e(),n(6),e(),r(7,"p")(8,"strong"),n(9,"Vers\xE3o:"),e(),n(10),e(),r(11,"p")(12,"strong"),n(13,"Autor:"),e(),n(14),e(),r(15,"p")(16,"strong"),n(17,"\xDAltima Atualiza\xE7\xE3o:"),e(),n(18),e(),r(19,"button",3),u("click",function(){p(t);let i=d();return g(i.fecharVersao())}),n(20,"Fechar"),e()()}if(s&2){let t=d();l(6),m(" ",t.sistemaVersao==null?null:t.sistemaVersao.project,""),l(4),m(" ",t.sistemaVersao==null?null:t.sistemaVersao.version,""),l(4),m(" ",t.sistemaVersao==null?null:t.sistemaVersao.author,""),l(4),m(" ",t.sistemaVersao==null?null:t.sistemaVersao.lastUpdate,"")}}function Y(s,o){if(s&1&&(r(0,"div")(1,"p")(2,"strong"),n(3,"Total:"),e(),n(4),e()()),s&2){let t=d();l(4),m(" $",t.valorCaixa.toFixed(2),"")}}function Z(s,o){if(s&1){let t=v();r(0,"div",14)(1,"h3"),n(2,"Novo Ve\xEDculo"),e(),r(3,"form",15,0),u("ngSubmit",function(){p(t);let i=d();return g(i.registrarEntrada())}),r(5,"input",16),C("ngModelChange",function(i){p(t);let c=d();return f(c.novoVeiculo.plate,i)||(c.novoVeiculo.plate=i),g(i)}),e(),r(6,"input",17),C("ngModelChange",function(i){p(t);let c=d();return f(c.novoVeiculo.model,i)||(c.novoVeiculo.model=i),g(i)}),e(),r(7,"input",18),C("ngModelChange",function(i){p(t);let c=d();return f(c.novoVeiculo.color,i)||(c.novoVeiculo.color=i),g(i)}),e(),r(8,"input",19),C("ngModelChange",function(i){p(t);let c=d();return f(c.novoVeiculo.ownerName,i)||(c.novoVeiculo.ownerName=i),g(i)}),e(),r(9,"div",20)(10,"button",21),n(11,"Registrar"),e(),r(12,"button",22),u("click",function(){p(t);let i=d();return g(i.fecharFormulario())}),n(13,"Cancelar"),e()()()()}if(s&2){let t=d();l(5),b("ngModel",t.novoVeiculo.plate),l(),b("ngModel",t.novoVeiculo.model),l(),b("ngModel",t.novoVeiculo.color),l(),b("ngModel",t.novoVeiculo.ownerName)}}function tt(s,o){if(s&1){let t=v();r(0,"tr")(1,"td"),n(2),e(),r(3,"td"),n(4),e(),r(5,"td"),n(6),e(),r(7,"td"),n(8),e(),r(9,"td"),n(10),M(11,"date"),e(),r(12,"td")(13,"button",3),u("click",function(){let i=p(t).$implicit,c=d();return g(c.registrarSaida(i.id))}),n(14,"Registrar Sa\xEDda"),e()()()}if(s&2){let t=o.$implicit;l(2),_(t.plate),l(2),_(t.model),l(2),_(t.color),l(2),_(t.ownerName),l(2),_(w(11,5,t.entryTime,"short"))}}var L=class s{constructor(o,t,a){this.dashboardService=o;this.router=t;this.http=a}vehicles=[];novoVeiculo={plate:"",model:"",color:"",ownerName:""};exibirFormulario=!1;cashToday=null;mostrarCaixa=!1;ngOnInit(){this.carregarVeiculos()}carregarVeiculos(){this.dashboardService.getActiveVehicles().subscribe({next:o=>this.vehicles=o,error:o=>console.error("Erro ao buscar ve\xEDculos:",o)})}abrirFormulario(){this.exibirFormulario=!0}fecharFormulario(){this.exibirFormulario=!1}registrarEntrada(){let{plate:o,model:t,color:a,ownerName:i}=this.novoVeiculo;if(!o||!t||!a||!i){alert("Preencha todos os campos antes de registrar.");return}this.http.post("https://localhost:7105/api/Vehicles/entry",this.novoVeiculo).subscribe({next:()=>{alert("Ve\xEDculo registrado com sucesso!"),this.novoVeiculo={plate:"",model:"",color:"",ownerName:""},this.carregarVeiculos(),this.fecharFormulario()},error:c=>{console.error("Erro ao registrar entrada:",c),alert("Erro ao registrar ve\xEDculo.")}})}registrarSaida(o){let t=window.prompt("Informe o valor adicional a ser cobrado (em d\xF3lares):","0");if(t===null)return;let a=parseFloat(t);if(isNaN(a)){alert("Valor inv\xE1lido. Sa\xEDda cancelada.");return}window.confirm(`Deseja confirmar a sa\xEDda com valor adicional de $${a.toFixed(2)}?`)&&this.http.put(`https://localhost:7105/api/Vehicles/exit/${o}`,a).subscribe({next:()=>{alert("Sa\xEDda registrada com sucesso!"),this.carregarVeiculos()},error:c=>{console.error("Erro ao registrar sa\xEDda:",c),alert("Erro ao registrar sa\xEDda: "+c.error)}})}carregarCaixaHoje(){this.http.get("https://localhost:7105/api/Cash/today").subscribe({next:o=>{this.cashToday=o.total,this.mostrarCaixa=!0},error:o=>{console.error("Erro ao carregar caixa do dia:",o),alert("Erro ao carregar caixa do dia")}})}verCaixa(){this.carregarCaixaHoje()}filtroData="";valorCaixa=null;buscarCaixaPorData(){if(!this.filtroData){alert("Selecione uma data para filtrar.");return}let o=new Date(this.filtroData).toISOString().split("T")[0];this.http.get(`https://localhost:7105/api/Cash/${o}`).subscribe({next:t=>{this.valorCaixa=t.total},error:t=>{console.error("Erro ao buscar caixa por data:",t),alert("Erro ao buscar caixa.")}})}verHistorico(){this.router.navigate(["/history"])}sistemaStatus=null;mostrarStatus=!1;sistemaVersao=null;mostrarVersao=!1;carregarStatusSistema(){this.http.get("https://localhost:7105/api/Settings/status").subscribe({next:o=>{this.sistemaStatus=o,this.mostrarStatus=!0},error:o=>{console.error("Erro ao buscar status:",o),alert("Erro ao buscar status.")}})}carregarVersaoSistema(){this.http.get("https://localhost:7105/api/Settings/version").subscribe({next:o=>{this.sistemaVersao=o,this.mostrarVersao=!0},error:o=>{console.error("Erro ao buscar vers\xE3o:",o),alert("Erro ao buscar vers\xE3o.")}})}fecharStatus(){this.mostrarStatus=!1}fecharVersao(){this.mostrarVersao=!1}atualizar(){this.carregarVeiculos()}static \u0275fac=function(t){return new(t||s)(S(V),S(H),S(E))};static \u0275cmp=P({type:s,selectors:[["app-dashboard"]],decls:47,vars:7,consts:[["formulario","ngForm"],[1,"dashboard-container"],[1,"controls"],[3,"click"],["class","caixa-container",4,"ngIf"],["class","status-box",4,"ngIf"],[1,"caixa-section"],["type","date",3,"ngModelChange","ngModel"],[4,"ngIf"],["class","formulario-container",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"caixa-container"],[1,"valor-caixa"],[1,"status-box"],[1,"formulario-container"],[3,"ngSubmit"],["type","text","name","plate","placeholder","Placa","required","",3,"ngModelChange","ngModel"],["type","text","name","model","placeholder","Modelo","required","",3,"ngModelChange","ngModel"],["type","text","name","color","placeholder","Cor","required","",3,"ngModelChange","ngModel"],["type","text","name","ownerName","placeholder","Propriet\xE1rio","required","",3,"ngModelChange","ngModel"],[1,"form-buttons"],["type","submit"],["type","button",3,"click"]],template:function(t,a){t&1&&(r(0,"div",1)(1,"h2"),n(2,"\u{1F697} Ve\xEDculos Ativos"),e(),r(3,"div",2)(4,"button",3),u("click",function(){return a.verCaixa()}),n(5,"\u{1F4B0} Ver Caixa"),e(),r(6,"button",3),u("click",function(){return a.verHistorico()}),n(7,"\u{1F4DC} Ver Hist\xF3rico"),e(),r(8,"button",3),u("click",function(){return a.atualizar()}),n(9,"\u{1F504} Atualizar"),e(),r(10,"button",3),u("click",function(){return a.abrirFormulario()}),n(11,"\u2795 Adicionar Ve\xEDculo"),e(),r(12,"button",3),u("click",function(){return a.router.navigate(["/register"])}),n(13,"\u2795 Registrar Funcion\xE1rio"),e()(),x(14,K,5,1,"div",4),r(15,"div",2)(16,"button",3),u("click",function(){return a.carregarStatusSistema()}),n(17,"\u2699\uFE0F Ver Status"),e(),r(18,"button",3),u("click",function(){return a.carregarVersaoSistema()}),n(19,"\u{1F4C4} Vers\xE3o"),e()(),x(20,Q,22,7,"div",5)(21,X,21,4,"div",5),r(22,"section",6)(23,"h3"),n(24,"\u{1F4C5} Consultar Caixa por Data"),e(),r(25,"input",7),C("ngModelChange",function(c){return f(a.filtroData,c)||(a.filtroData=c),c}),e(),r(26,"button",3),u("click",function(){return a.buscarCaixaPorData()}),n(27,"Buscar"),e(),x(28,Y,5,1,"div",8),e(),x(29,Z,14,4,"div",9),r(30,"table")(31,"thead")(32,"tr")(33,"th"),n(34,"Placa"),e(),r(35,"th"),n(36,"Modelo"),e(),r(37,"th"),n(38,"Cor"),e(),r(39,"th"),n(40,"Propriet\xE1rio"),e(),r(41,"th"),n(42,"Entrada"),e(),r(43,"th"),n(44,"A\xE7\xF5es"),e()()(),r(45,"tbody"),x(46,tt,15,8,"tr",10),e()()()),t&2&&(l(14),h("ngIf",a.mostrarCaixa),l(6),h("ngIf",a.mostrarStatus),l(),h("ngIf",a.mostrarVersao),l(4),b("ngModel",a.filtroData),l(3),h("ngIf",a.valorCaixa!==null),l(),h("ngIf",a.exibirFormulario),l(17),h("ngForOf",a.vehicles))},dependencies:[T,k,O,I,U,R,N,j,A,z,B,W],styles:["body[_ngcontent-%COMP%]{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background-color:#f4f6f8;margin:0;padding:20px;color:#333}.dashboard-container[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;background-color:#fff;padding:24px;border-radius:12px;box-shadow:0 4px 12px #0000001a}h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:24px;color:#2c3e50}.controls[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:24px}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;border:none;padding:10px 16px;border-radius:6px;cursor:pointer;font-weight:600;transition:background-color .2s}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#2980b9}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:16px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:12px;text-align:center}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#3498db;color:#fff}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f2f2f2}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#27ae60;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#219150}.formulario-container[_ngcontent-%COMP%]{background-color:#ecf0f1;border:1px solid #ccc;border-radius:10px;padding:16px;margin-bottom:24px;max-width:400px;margin-left:auto;margin-right:auto}.formulario-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;margin-bottom:12px;padding:10px;border-radius:6px;border:1px solid #bbb}.form-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.form-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:6px;font-weight:700;cursor:pointer}.form-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{background-color:#2ecc71;color:#fff}.form-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{background-color:#e74c3c;color:#fff}.status-box[_ngcontent-%COMP%]{background-color:#f9f9f9;border-left:5px solid #198754;padding:15px;margin-top:20px;border-radius:8px;box-shadow:0 0 5px #0000001a}.status-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:10px;background-color:#dc3545}"]})};export{L as DashboardComponent};
